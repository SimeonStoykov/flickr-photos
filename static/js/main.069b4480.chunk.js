(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{26:function(e,t,a){e.exports=a.p+"static/media/flickr-loading.6bbf9220.svg"},28:function(e,t,a){e.exports=a(52)},33:function(e,t,a){},39:function(e,t,a){},41:function(e,t,a){},43:function(e,t,a){},52:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(16),c=a.n(o),s=(a(33),a(9)),l=a(12),h=a(15),i=a(20),u={flickrURL:"https://www.flickr.com",flickrSearchPhotosURL:"https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=".concat("a6daa1a6c8345eff867cc2ef240aa832"),resultsPerPage:16},p=function(e){var t=e.currentPage,a=e.searchTerm,r=a?"&text=".concat(a):"",n=Math.round((new Date).getTime()/1e3),o="".concat(u.flickrSearchPhotosURL).concat(r,"&max_upload_date=").concat(n,"&safe_search=1&extras=tags%2Cdescription%2Cowner_name&page=").concat(t,"&per_page=").concat(u.resultsPerPage,"&format=json&nojsoncallback=1"),c=t>1;return function(e){return e(function(e){return{type:"FETCH_PHOTOS_BEGIN",loadMorePhotos:e}}(c)),fetch(o).then(f).then(function(e){return e.json()}).then(function(t){return e({type:"FETCH_PHOTOS_SUCCESS",payload:(a={photosResp:t,loadMorePhotos:c}).photosResp,loadMorePhotos:a.loadMorePhotos});var a}).catch(function(t){return e(function(e){return{type:"FETCH_PHOTOS_FAILURE",payload:{error:e}}}(t))})}};function f(e){if(!e.ok)throw Error(e.statusText);return e}var d=function(e){return{type:"SET_CURRENT_PAGE",value:e}},m=Object(i.a)({searchInputValue:"",searchTerm:"",currentPage:1,totalPages:0,fetchPhotosLoading:!1,fetchPhotosError:null,photos:[]}),g=a(25),P=Object(l.c)({photosData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_PHOTOS_BEGIN":var a=t.loadMorePhotos?e.get("photos"):m.get("photos");return e.set("fetchPhotosLoading",!0).set("fetchPhotosError",m.get("fetchPhotosError")).set("photos",a);case"FETCH_PHOTOS_SUCCESS":var r=[],n=m.get("totalPages");t.payload&&t.payload.photos&&(t.payload.photos.photo&&(r=t.payload.photos.photo),t.payload.photos.pages&&(n=t.payload.photos.pages));var o=r=r.map(function(e){return e.src="https://farm".concat(e.farm,".staticflickr.com/").concat(e.server,"/").concat(e.id,"_").concat(e.secret,".jpg"),e});if(t.loadMorePhotos){for(var c=e.get("photos").toJS(),s=function(e){var t=r[e];c.find(function(e){return e.id===t.id})||c.push(t)},l=0;l<r.length;l++)s(l);o=Object(h.a)(c)}return e.set("fetchPhotosLoading",m.get("fetchPhotosLoading")).set("photos",Object(i.a)(o)).set("totalPages",n);case"FETCH_PHOTOS_FAILURE":return e.set("fetchPhotosLoading",m.get("fetchPhotosLoading")).set("fetchPhotosError",t.payload.error);case"SET_SEARCH_INPUT_VALUE":return e.set("searchInputValue",t.value);case"SET_SEARCH_TERM":return e.set("searchTerm",t.value);case"SET_CURRENT_PAGE":return e.set("currentPage",t.value);default:return e}}}),E=Object(l.d)(P,Object(l.a)(g.a)),v=a(54),b=a(56),O=a(55),T=a(6),j=a(7),_=a(11),y=a(8),S=a(10),C=a(5),k=function(e){function t(){var e;return Object(T.a)(this,t),(e=Object(_.a)(this,Object(y.a)(t).call(this))).searchPhotos=e.searchPhotos.bind(Object(C.a)(Object(C.a)(e))),e.handleSearchInputValueChange=e.handleSearchInputValueChange.bind(Object(C.a)(Object(C.a)(e))),e.handleKeyPress=e.handleKeyPress.bind(Object(C.a)(Object(C.a)(e))),e}return Object(S.a)(t,e),Object(j.a)(t,[{key:"handleSearchInputValueChange",value:function(e){this.props.setSearchInputValue(e.target.value)}},{key:"handleKeyPress",value:function(e){"Enter"===e.key&&this.props.searchInputValue&&this.searchPhotos()}},{key:"searchPhotos",value:function(){var e=this.props,t=e.setCurrentPage,a=e.setSearchTerm,r=e.searchInputValue,n=e.fetchPhotos,o=r.trim();a(o),t(1),n({currentPage:1,searchTerm:o})}},{key:"render",value:function(){return n.a.createElement("div",{className:"header--search-bar"},n.a.createElement("input",{type:"text",value:this.props.searchInputValue,onChange:this.handleSearchInputValueChange,onKeyPress:this.handleKeyPress,placeholder:"Search in title, description and tags..."}),n.a.createElement("button",{onClick:this.searchPhotos,disabled:!this.props.searchInputValue}))}}]),t}(r.Component),w=Object(s.b)(function(e){var t=e.photosData;return{searchInputValue:t.get("searchInputValue"),searchTerm:t.get("searchTerm"),currentPage:t.get("currentPage")}},function(e){return{fetchPhotos:function(t){return e(p(t))},setSearchInputValue:function(t){return e(function(e){return{type:"SET_SEARCH_INPUT_VALUE",value:e}}(t))},setSearchTerm:function(t){return e(function(e){return{type:"SET_SEARCH_TERM",value:e}}(t))},setCurrentPage:function(t){return e(d(t))}}})(k),N=a(14),I=Object(N.a)(),L=(a(39),"/"),R=function(e){var t=e.currentPath;return n.a.createElement("header",{className:"header"},n.a.createElement("h1",{className:"header--title",onClick:function(){t!==L?I.push(L):window.location.reload()}},"Flickr Photos"),n.a.createElement(w,null))},H=function(e){var t=e.data,a="".concat(u.flickrURL,"/photos/").concat(t.owner,"/").concat(t.id),r="".concat(u.flickrURL,"/people/").concat(t.owner),o=t.title.length>20?t.title.substr(0,20)+"...":t.title,c=t.description&&t.description._content&&t.description._content.trim(),s="";c&&(s=c.length>40?c.substr(0,40)+"...":c);var l=[];t.tags&&(l=t.tags.split(" "));var i=l.length>5?l.slice(0,5).join(", ")+"...":Object(h.a)(l).join(", ");return n.a.createElement("div",{className:"photos-list--card"},n.a.createElement("a",{href:a,target:"_blank",rel:"noopener noreferrer",title:t.title},n.a.createElement("img",{src:t.src,alt:"",className:"photo-list--card--image"})),n.a.createElement("a",{href:a,target:"_blank",rel:"noopener noreferrer",title:t.title},o),n.a.createElement("span",null," by "),n.a.createElement("a",{href:r,target:"_blank",rel:"noopener noreferrer"},t.ownername),s&&n.a.createElement("p",{className:"photo-list--card--description",title:c},"Description: ".concat(s)),i.length>0&&n.a.createElement("div",{title:l.join(", ")},"Tags: ",i))},V=(a(41),a(26)),U=a.n(V),A=(a(43),function(){return n.a.createElement("div",{className:"loading"},n.a.createElement("img",{src:U.a,alt:"Loading...",className:"loading-img"}),n.a.createElement("div",null,"Loading..."))}),M=a(17),F=a.n(M),x=function(e){function t(){var e;return Object(T.a)(this,t),e=Object(_.a)(this,Object(y.a)(t).call(this)),window.onscroll=function(){var t=e.props,a=t.setCurrentPage,r=t.fetchPhotos,n=t.currentPage,o=t.searchTerm,c=t.totalPages;if(window.innerHeight+document.documentElement.scrollTop===document.documentElement.offsetHeight){if(c===n)return;a(n+1),r({currentPage:n+1,searchTerm:o})}},e}return Object(S.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){var e=this.props;(0,e.fetchPhotos)({currentPage:1,searchTerm:e.searchTerm})}},{key:"render",value:function(){var e=this.props,t=e.photos,a=e.fetchPhotosLoading,r=e.fetchPhotosError,o=e.searchTerm,c=e.currentPage,s=e.totalPages;return n.a.createElement("main",null,o&&t.length>0&&!a&&n.a.createElement("div",{className:"results-for"},'Results for "',o,'"'),n.a.createElement("div",{className:"photos-list"},0!==t.length||a?"":n.a.createElement("div",{className:"photo-list--no-results"},'No results found for "',o,'"'),t.map(function(e){return n.a.createElement(F.a,{key:e.id,height:300},n.a.createElement(H,{data:e}))}),a&&n.a.createElement(A,null),r&&n.a.createElement("div",{className:"photo-list--error-message"},"Error! ",r.message),s===c&&!a&&n.a.createElement("div",{className:"photo-list--no-results"},"No more results!")))}}]),t}(r.Component),D=Object(s.b)(function(e){var t=e.photosData;return{fetchPhotosLoading:t.get("fetchPhotosLoading"),fetchPhotosError:t.get("fetchPhotosError"),photos:t.get("photos").toJS(),searchTerm:t.get("searchTerm"),currentPage:t.get("currentPage"),totalPages:t.get("totalPages")}},function(e){return{fetchPhotos:function(t){return e(p(t))},setCurrentPage:function(t){return e(d(t))}}})(x),K=function(e){function t(){return Object(T.a)(this,t),Object(_.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(S.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"app"},n.a.createElement(R,{currentPath:this.props.location.pathname}),n.a.createElement(D,null))}}]),t}(r.Component);c.a.render(n.a.createElement(s.a,{store:E},n.a.createElement(function(){return n.a.createElement(v.a,{basename:"/flickr-photos",history:I},n.a.createElement(b.a,null,n.a.createElement(O.a,{exact:!0,path:"/",component:K})))},null)),document.getElementById("root"))}},[[28,2,1]]]);
//# sourceMappingURL=main.069b4480.chunk.js.map